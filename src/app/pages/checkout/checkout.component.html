<div *ngIf="InvoiceDatasource" class="flex w-full h-screen lg:h-full bg-gray-700 justify-center">
    <!-- Payment Panel -->
    <div *ngIf="!IsPaymentSuccess" class="flex flex-col items-center max-w-[480px] w-full bg-gray-50 relative">
        <!-- Sandbox Mode -->
        <div *ngIf="IsSandboxMode" class="flex w-full p-2 bg-yellow-500 justify-center text-center">
            <p class="text-xs text-gray-700 text-center">
                Anda Sedang Berada Di Mode Sandbox
            </p>
        </div>

        <!-- Header -->
        <div
            class="flex flex-row justify-center w-full gap-2 pt-5 pb-3 {{ IsSandboxMode ? 'h-[12rem]' : 'h-[10rem]' }} bg-gray-700">
            <!-- Logo -->
            <img [src]="Logo" alt="logo" class="h-[3rem] mx-auto mb-10">
        </div>

        <!-- Order Summary -->
        <div
            class="flex flex-col w-11/12 max-w-[450px] p-2 gap-0 bg-white rounded-lg shadow drop-shadow absolute {{ IsSandboxMode ? 'top-[120px]' : 'top-[85px]' }}">
            <div class="flex w-full justify-between items-center mb-1">
                <p class="text-gray-500 text-xs">
                    Total
                </p>

                <p class="text-sky-600 text-sm font-semibold">
                    {{ InvoiceDatasource.full_name }}
                </p>
            </div>

            <p class="text-gray-800 text-3xl font-bold mb-2">
                {{ InvoiceDatasource.total | currency: 'Rp. ' }}
            </p>

            <div class="flex flex-col w-full gap-0">
                <!-- Invoice No -->
                <div class="flex w-full">
                    <div class="w-3/12">
                        <p class="text-gray-500 text-xs">
                            ID Pelanggan
                        </p>
                    </div>
                    <div class="w-9/12">
                        <p class="text-gray-600 text-xs font-medium">
                            : {{ InvoiceDatasource.pelanggan_code }}
                        </p>
                    </div>
                </div>

                <!-- Invoice No -->
                <div class="flex w-full">
                    <div class="w-3/12">
                        <p class="text-gray-500 text-xs">
                            No. Invoice
                        </p>
                    </div>
                    <div class="w-9/12">
                        <p class="text-gray-600 text-xs font-medium">
                            : {{ InvoiceDatasource.invoice_number }}
                        </p>
                    </div>
                </div>

                <!-- Jatuh Tempo -->
                <div class="flex w-full">
                    <div class="w-3/12">
                        <p class="text-gray-500 text-xs">
                            Jatuh Tempo
                        </p>
                    </div>
                    <div class="w-9/12">
                        <p class="text-gray-600 text-xs font-medium">
                            : {{ InvoiceDatasource.due_date | date: 'dd MMMM yyyy' }}
                        </p>
                    </div>
                </div>

                <!-- Jatuh Tempo -->
                <div class="flex w-full">
                    <div class="w-3/12">
                        <p class="text-gray-500 text-xs">
                            Alamat
                        </p>
                    </div>
                    <div class="w-9/12">
                        <p class="text-gray-600 text-xs font-medium">
                            : {{ InvoiceDatasource.alamat }}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment Method -->
        <div class="flex flex-col w-full gap-0 p-3 pt-[6rem]">
            <p class="text-base text-sky-600 font-semibold">
                <span *ngIf="IsPaymentGenerated" class="text-gray-700" (click)="changePaymentMethod()">
                    <i class="pi pi-chevron-left" style="font-size: 12px"></i>
                </span>
                {{ IsPaymentGenerated ? DetailPayment.payment_method : 'Pilih Metode Bayar' }}
            </p>

            <p *ngIf="!IsPaymentGenerated" class="text-xs text-gray-500 mb-5">
                Pembayaran dapat dilakukan melalui VA atau QRIS
            </p>

            <!-- List Payment Method -->
            <div *ngIf="!IsPaymentGenerated" class="flex flex-col w-full overflow-x-auto gap-3 pb-2"
                style="height: calc(100vh - 23rem);">
                <div *ngFor="let item of PaymentMethodDatasource"
                    class="flex flex-row items-center w-full gap-2 bg-gray-200 p-2 rounded-lg shadow"
                    (click)="createPayment(item)">
                    <img [src]="item.image" alt="logo_payment_method" class="w-[40px] h-[auto]">

                    <div class="flex flex-col w-full">
                        <p class="text-sm text-gray-700 font-semibold">
                            {{ item.payment_method_name }}
                        </p>
                        <p class="text-xs text-gray-500">
                            {{ item.payment_method_type == 'QRIS' ? '' : 'Virtual Account Bank' }}
                            {{ item.payment_method_code }}
                        </p>
                    </div>

                    <span class="text-sm text-gray-700 cursor-pointer">
                        <i class="pi pi-chevron-right" style="font-size: 12px"></i>
                    </span>
                </div>
            </div>

            <!-- Payment VA and Instructions -->
            <div *ngIf="DetailPayment" class="flex flex-col w-full gap-2 my-2">
                <p *ngIf="DetailPayment.payment_method != 'QRIS'" class="text-gray-700 text-sm mb-2">
                    Lakukan pembayaran dari rekening Bank {{ DetailPayment.payment_method }} ke nomor virtual account
                    dibawah ini.
                </p>

                <div *ngIf="DetailPayment.payment_method != 'QRIS'"
                    class="flex flex-row w-full justify-between items-center p-2 bg-gray-200 rounded-md drop-shadow">
                    <div class="flex flex-col">
                        <p class="text-sm text-gray-600">
                            Nomor virtual account
                        </p>
                        <p class="text-lg text-gray-800 font-semibold">
                            {{ DetailPayment.payment_number }}
                        </p>
                    </div>

                    <span class="text-sky-500">
                        <i class="pi pi-copy" style="font-size: 17px;"></i>
                    </span>
                </div>

                <p *ngIf="DetailPayment.payment_method == 'QRIS'" class="text-gray-700 text-sm mb-2">
                    Lakukan pembayaran ke QRIS dibawah ini.
                </p>

                <div *ngIf="DetailPayment.payment_method == 'QRIS'"
                    class="flex flex-row w-full justify-center items-center p-2 bg-gray-200 rounded-md drop-shadow">
                    <qrcode [qrdata]="DetailPayment.payment_number" [width]="200" [errorCorrectionLevel]="'M'">
                    </qrcode>
                </div>
            </div>

            <!-- Payment Instructions -->
            <div *ngIf="DetailPayment && SelectedPaymentMethod && DetailPayment.payment_method != 'QRIS'"
                class="flex flex-col w-full gap-2 mt-3 pt-3 border-t border-b-0 border-x-0 border-dashed border-gray-300 h-[24rem] overflow-x-auto">
                <p class="text-gray-700 font-semibold text-base">
                    Cara Bayar
                </p>

                <div *ngFor="let item of SelectedPaymentMethod.payment_method_instruction; let i = index"
                    class="flex flex-col w-full">
                    <p class="text-sm text-gray-600 font-semibold">
                        {{ i + 1}}. {{ item.type }}
                    </p>

                    <div class="grid p-3 text-xs text-gray-600" [innerHTML]="item.instructions"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Paid Panel -->
    <div *ngIf="IsPaymentSuccess"
        class="flex flex-col items-center justify-center max-w-[480px] w-full h-full bg-emerald-100">
        <i class="pi pi-check text-emerald-500" style="font-size: 3rem"></i>

        <p
            class="text-xl text-gray-700 font-semibold my-2 pb-10 border-b border-t-0 border-x-0 border-solid border-emerald-400">
            Pembayaran Berhasil
        </p>

        <p class="text-3xl text-gray-700 font-bold mt-5 mb-1">
            {{ InvoiceDatasource.total | currency: 'Rp. ' }}
        </p>

        <p class="text-xs text-gray-500 mb-5">
            No. Invoice : {{ InvoiceDatasource.invoice_number }}
        </p>

        <p-button severity="secondary" styleClass="p-button-sm w-full" label="Kembali Ke Halaman Utama"></p-button>
    </div>
</div>